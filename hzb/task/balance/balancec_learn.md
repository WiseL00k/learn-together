# ROS 两轮平衡小车仿真项目开发总结

## 概述：目前采用多环PID控制,正在进一步学习与完善


| 功能             | 完成情况   |  说明 |
| ---------------- | -------- | ---- |
| 平衡小车URDF     |车体由长方体底盘与两个圆柱体轮组成，IMU安装在底盘中心| 各link的惯性矩阵符合现实  |
| 平衡小车关节驱动 |  配备effort接口 |      |
| 运动需求实现    | 重开控制器后可实现自启，在一定距离内可实现稳定，前后移动与转向功能实现正常 |   关于原地稳定效果正在进一步优化  |
| ...              | ...      | ...  |



### 控制流程：
1.速度环（外环）：

输入：目标速度与实际速度差值

过程：使用control_toolbox的kp,ki计算出目标pitch，同时对目标pitch进行限幅（$\pm 0.25$ rad ）

2.位置环 （内环）：

输入：target_pitch 与当前 IMU 实际 Pitch 角的差值。

逻辑：利用 PD 控制（高响应 P，强阻尼 D）计算维持平衡所需的力矩。

3.转向采用开环比例，对yaw_error使用pd，叠加转向力矩差值至两轮

### 开发过程遇到的问题与解决

1.抬高小车重心使其更符合实际情况

2.初次为维持稳定，P值给的太大，导致力矩吃满的同时持续震荡，其他PID控制不起作用。后来采用串级PID控制，不再是所有环路直接作用于力矩，同时整体改小PD参数，为转向yaw的PID控制留出力矩余量